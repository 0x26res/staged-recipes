From 1edd2a2b43f46217d6862f8cf49e1664f4a493d9 Mon Sep 17 00:00:00 2001
From: Mark Harfouche <mark.harfouche@gmail.com>
Date: Sun, 1 Dec 2024 16:05:00 +0530
Subject: [PATCH] Find glfw correctly for conda-forge

---
 bindings/imgui_bundle/_glfw_set_search_path.py | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/bindings/imgui_bundle/_glfw_set_search_path.py b/bindings/imgui_bundle/_glfw_set_search_path.py
index 1a3c457d..7328802a 100644
--- a/bindings/imgui_bundle/_glfw_set_search_path.py
+++ b/bindings/imgui_bundle/_glfw_set_search_path.py
@@ -15,20 +15,23 @@ def _glfw_set_search_path() -> None:
     """
     import os
     import platform
+    import sys
 
-    this_dir = os.path.dirname(__file__)
     if platform.system() == "Darwin":
+        this_dir = os.path.join(sys.exec_prefix, "lib")
         lib_file = "libglfw.3.dylib"
         if not os.path.exists(f"{this_dir}/{lib_file}"):
             msg = f"Cannot find {lib_file} in {this_dir}\n"
             raise FileNotFoundError(msg)
     elif platform.system() == "Windows":
+        this_dir = os.path.join(sys.exec_prefix, "Library", "bin")
         if os.path.exists(f"{this_dir}/glfw3.dll"):
             lib_file = "glfw3.dll"
         else:
             msg = f"Cannot find glfw3.dll in {this_dir}\n"
             raise FileNotFoundError(msg)
     elif platform.system() == "Linux":
+        this_dir = os.path.join(sys.exec_prefix, "lib")
         if os.path.exists(f"{this_dir}/libglfw.so.3"):
             lib_file = "libglfw.so.3"
         elif os.path.exists(f"{this_dir}/libglfw.3.so"):
-- 
2.45.2

