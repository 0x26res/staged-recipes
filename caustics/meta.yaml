{% set name = "caustics" %}
{% set version = "0.8.0" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://pypi.io/packages/source/{{ name[0] }}/{{ name }}/caustics-{{ version }}.tar.gz
  sha256: 469d970fe9d5c3cc265dd29342ee7402af0f76dc2c05dd7208173a276fd651ca

build:
  noarch: python
  script: {{ PYTHON }} -m pip install . -vv
  number: 0

requirements:
  host:
    - python >=3.9
    - hatchling
    - hatch-requirements-txt
    - hatch-vcs
    - pip
  run:
    - python >=3.9
    - astropy <6.0.0,>=5.2.1
    - python-graphviz ==0.20.1
    - h5py >=3.8.0
    - numba <0.59.0,>=0.58.1
    - numpy >=1.23.5
    - safetensors >=0.4.1
    - scipy >=1.8.0
    - pytorch >=2.0.0

test:
  imports:
    - caustics
  commands:
    - pip check
    - python -c "import caustics; assert caustics.__version__ != '0.0.0'; caustics.test()"
  requires:
    - pip

about:
  summary: 'The lensing pipeline of the future: GPU-accelerated, automatically-differentiable, highly modular. Currently under heavy development: expect interface changes and some imprecise/untested calculations.'
  license: MIT
  license_file: LICENSE

extra:
  recipe-maintainers:
    - lsetiawan
    - uwcdc
    - ConnorStoneAstro
