{% set name = "libertem-live" %}
{% set version = "0.2.0" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://pypi.io/packages/source/{{ name[0] }}/{{ name }}/libertem-live-{{ version }}.tar.gz
  sha256: f28bb6d01cd0c6f066c61c60c8368defda375b01ce0da67b8a6b7ebcee16440b

build:
  entry_points:
    - libertem-live-mib-sim=libertem_live.detectors.merlin.sim:main
    - libertem-live-dectris-sim=libertem_live.detectors.dectris.sim:main
    - libertem-live-asi-tpx-sim=libertem_live.detectors.asi_tpx3.sim:main
  noarch: python
  script: {{ PYTHON }} -m pip install . -vv
  number: 0

requirements:
  host:
    - python >=3.7,<3.11
    - pip
  run:
    - python >=3.7,<3.11
    - libertem >=0.11.0.dev0
    - numpy
    - click
    - tqdm
    - numba
    - opentelemetry-api
    - sparseconverter
    - libertem-dectris
    - libertem-asi-tpx3

test:
  imports:
    - libertem_live
  commands:
    - pip check
    - libertem-live-mib-sim --help
    - libertem-live-dectris-sim --help
    - libertem-live-asi-tpx-sim --help
    # - pytest tests
  # source_files:
    # - tests
    # - conftest.py   # missing conftest.py is source tarball
    # - pytest.ini
  requires:
    - pip
    - flask
  #   - pytest >=6
  #   - pytest-cov
  #   - pytest-asyncio >0.11
  #   - pytest-xdist
  #   - pytest-env
  #   - pytest-benchmark
  #   - pytest-timeout
  #   - aiohttp
  #   - websockets
  #   - ipykernel
  #   - nest-asyncio

about:
  home: https://libertem.github.io/LiberTEM-live
  summary: Live processing with LiberTEM
  license: GPL-3.0 AND MIT
  license_file:
    - LICENSE
    - src/libertem_live/detectors/LICENSE
  description: |
    LiberTEM-live is an extension module for
    LiberTEM that allows live data processing.

extra:
  recipe-maintainers:
    - sk1p
    - uellue
    - matbryan52
