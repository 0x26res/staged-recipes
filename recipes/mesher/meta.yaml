{% set name = "mesher" %}
{% set version = "2.1.4" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://pypi.io/packages/source/{{ name[0] }}/{{ name }}/mesher-{{ version }}.tar.gz
  sha256: a142b6c5773187ddd98bb9f422a9a8545f90f2482f4c9f5089b1f7f54ea30caf

build:
  entry_points:
    - mesher = mesher:main
    - mesh2shp = mesher.tools.mesh2shp:main
    - mesh2vtu = mesher.tools.mesh2vtu:main
    - mesh2merge = mesher.tools.meshmerge:main
    - meshpermutation = mesher.tools.meshpermutation:main
    - meshstats = mesher.tools.meshstats:main
  script: {{ PYTHON }} -m pip install . -vv --no-deps --no-build-isolation
  number: 0
  noarch: python

requirements:
  build:
    - cmake
    - ninja
    - make
    - {{ compiler('cxx') }}
  host:
    - python >=3.7
    - scikit-build-core
    - cmake
    - pip
    - cgal-cpp
    - libboost-devel
    - libgdal
    - metis
  run:
    - python >=3.7
    - vtk
    - numpy
    - scipy
    - matplotlib-base
    - cloudpickle
    - libgdal
    - gdal
    - metis
    - metis-python
    - mpi4py
    - natsort
    - libstdcxx-ng
    - libgcc-ng
    - gmp   
    - __unix  # [unix]

test:
  imports:
    - mesher
  commands:
    - pip check
    - mesher --help
    - mesh2shp --help
    - mesh2vtu --help
    - mesh2merge --help
    - meshpermutation --help
    - meshstats --help
  requires:
    - pip

about:
  home: https://github.com/Chrismarsh/mesher
  summary: Mesher is a novel multi-objective unstructured mesh generation software that allows mesh generation to be generated from an arbitrary number of hydrologically important features while maintaining a variable spatial resolution. Triangle quality is guaranteed as well as a smooth graduation from small to large triangles. Including these additional features resulted in a better representation of spatial heterogeneity versus classic topography-only mesh generation.
  license: GPL-3.0-or-later
  license_file: LICENSE

extra:
  recipe-maintainers:
    - Chrismarsh
