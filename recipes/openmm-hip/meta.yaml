{% set name = "openmm-hip" %}
{% set version = "8.1.1beta" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  - url: https://github.com/StreamHPC/openmm-hip/archive/refs/tags/{{ version }}.tar.gz
    sha256: 0136e5ccba7a0e97133d1ce5d902adc0efadf5535fbd7a7fcca3c4e5380a662e
    folder: openmm-hip
  - url: https://github.com/openmm/openmm/archive/refs/tags/8.1.1.tar.gz
    sha256: 347ad9f04dd88a673f7871127d9f23a75caf2c1a460a3f21f3328a24dc6547d0
    folder: openmm


build:
  number: 0
  skip: True  # [not linux]

requirements:
  build:
    - {{ compiler('c') }}
    - {{ compiler('cxx') }}
    - {{ stdlib('c') }}
    - cmake
    - make
  host:
    - compiler-rt
    - clangdev
    - hip-devel
    - hipcc
    - hipfft
    - lld
    - rocfft
    - rocm-cmake
    - rocm-device-libs
    - openmm 8.1.1
  run:
    - {{ pin_compatible("hipfft") }}
    - {{ pin_compatible("openmm") }}

test:
  requires:
    - pip
  commands:
    - pip check

about:
  home: https://openmm.org
  summary: Openmm-hip plugin
  description: |
    This plugin adds HIP platform that allows to run OpenMM on CDNA and RDNA AMD GPUs on AMD ROCm open software platform.
  license: MIT
  license_family: MIT
  license_file: openmm-hip/licenses/MIT.txt
  dev_url: https://github.com/StreamHPC/openmm-hip

extra:
  recipe-maintainers:
    - zklaus
    - hmacdope
    - ex-rzr
    - peastman
