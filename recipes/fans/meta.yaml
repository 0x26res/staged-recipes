{% set name = "FANS" %}
{% set version = "0.3.0" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://github.com/DataAnalyticsEngineering/FANS/archive/refs/tags/v{{ version }}.tar.gz
  sha256: 1573478d9acd27a9cfc126a4167ce3951ec26e9896bf19577b44cbc4bdc48b88

build:
  skip: True # [win or osx]
  number: 0
  script:
    - rm -rf build
    - mkdir build
    - cd build
    - cmake .. -DCMAKE_INSTALL_PREFIX=$PREFIX -DCMAKE_C_COMPILER=$PREFIX/bin/mpicc -DCMAKE_CXX_COMPILER=$PREFIX/bin/mpicxx
    - cmake --build . -j
    - cmake --install . --prefix $PREFIX

requirements:
  build:
    - {{ compiler('cxx') }}
    - {{ stdlib('c') }}
    - cmake
  host:
    - hdf5 * mpi_openmpi*
    - fftw * mpi_openmpi*
    - openmpi-mpicxx
    - eigen
  run:
    - hdf5 * mpi_openmpi*
    - fftw * mpi_openmpi*
    - openmpi-mpicxx
    - eigen

test:
  requires:
    - jq
  source_files:
    - test/input_files/test_LinearElastic.json
    - test/microstructures/sphere32.h5

about:
  home: https://github.com/DataAnalyticsEngineering/FANS
  summary: "FANS: an open-source, efficient, and parallel FFT-based homogenization solver designed to solve microscale multiphysics problems."
  description: |
    Fourier Accelerated Nodal Solvers (FANS) is an FFT-based homogenization solver designed to handle microscale multiphysics problems. |
    This repository contains a C++ implementation of FANS, built using CMake and MPI for parallel computations.
  license: 	LGPL-3.0-only
  license_family: LGPL
  license_file: LICENSE

extra:
  recipe-maintainers:
    - sanathkeshav
    - claudiushaag
    - EMMAOpenSource
