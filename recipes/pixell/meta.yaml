{% set name = "pixell" %}
{% set version = "0.26.1" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://pypi.io/packages/source/{{ name[0] }}/{{ name }}/pixell-{{ version }}.tar.gz
  sha256: a84070dfdf3701563f9fc3ea1ec454d7b71351edddb62ff51df1180f05d72ec2

build:
  skip: true  # [py<39 or win]
  entry_points:
    - benchmark-pixell-runner = pixell.scripts.benchmark_pixell_runner:main
    - benchmark-pixell = pixell.scripts.benchmark_pixell:main
  script: {{ PYTHON }} -m pip install . -vv --no-deps --no-build-isolation
  number: 0

requirements:
  build:
    - {{ compiler('c') }}
    - {{ compiler('fortran') }}
    - {{ stdlib("c") }}
    - make
  host:
    - python
    - meson-python
    - numpy
    - cython
    - versioneer
    - python-build
    - pip
  run:
    - python
    - astropy >=2.0
    - setuptools >=39
    - h5py >=2.7
    - scipy >=1.0
    - python-dateutil >=2.7
    - cython
    - healpy >=1.13
    - matplotlib-base >=2.0
    - pyyaml >=5.0
    - pillow >=5.3.0,!=10.4.0
    - pytest-cov >=2.6
    - coveralls >=1.5
    - pytest >=4.6
    - ducc0 >=0.34.0
    - numba >=0.54.0
    - {{ pin_compatible('numpy') }}

test:
  imports:
    - pixell
  commands:
    - pip check
    - benchmark-pixell-runner --help
    - benchmark-pixell --help
  requires:
    - pip

about:
  home: https://github.com/simonsobs/pixell/tree/master
  summary: A rectangular pixel map manipulation and harmonic analysis library derived from Sigurd Naess' enlib.
  description: |
    pixell is a library for loading, manipulating and analyzing maps stored in 
    rectangular pixelization. It is mainly targeted for use with maps of the 
    sky (e.g. CMB intensity and polarization maps, stacks of 21 cm intensity 
    maps, binned galaxy positions or shear) in cylindrical projection, but 
    its core functionality is more general. It extends numpyâ€™s ndarray to an 
    ndmap class that associates a World Coordinate System (WCS) with a numpy 
    array. It includes tools for Fourier transforms (through numpy or pyfft) 
    and spherical harmonic transforms (through ducc0) of such maps and tools 
    for visualization (through the Python Image Library).
  license: BSD-3-Clause
  license_file: LICENSE


extra:
  recipe-maintainers:
    - jborrow
    - msyriac
    - iparask
