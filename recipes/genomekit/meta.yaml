{% set version = "4.1.0" %}

package:
  name: genomekit
  version: {{ version }}

source:
  url: https://github.com/deepgenomics/GenomeKit/archive/refs/tags/v{{ version }}.tar.gz
  sha256: 5b37bd4767fb98c77ec50b4a1463520109cbc991465ee09675c0a9226d31f3ee

build:
  number: 0
  script: python -m pip install --no-deps --ignore-installed .
  skip: true # [py<38 or py>38]

requirements:
  build:
    - {{ compiler('cxx') }}

  host:
    - appdirs
    - fmt
    - numpy >=1.18.0,<1.19.0 # oldest py3.8 build for forward compatibility
    # TODO tensorflow TPU now also supports 3.10
    - python >=3.8.0,<3.9.0  # tensorflow TPU whls from google only support 3.8
    - typing-extensions
    - zlib

  run:
    - appdirs
    - crc32c
    - google-cloud-storage
    - {{ pin_compatible('numpy') }}
    - typing-extensions
    - importlib-metadata
    - tqdm

test:
  imports:
    - genome_kit
  requires:
    - bcftools
    - pytest-cov
    - samtools >=1.15
    - tabix
    - twobitreader

about:
  doc_url: https://genomekit.readthedocs.io/
  home: https://github.com/deepgenomics/GenomeKit
  license: "Apache-2.0"
  license_file: "LICENSE"
  summary: GenomeKit is a Python library for fast and easy access to genomic resources such as sequence, data tracks, and annotations.

extra:
  recipe-maintainers:
    - ovesh
