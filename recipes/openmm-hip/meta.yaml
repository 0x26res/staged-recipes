{% set name = "openmm-hip" %}
{% set version = "8.1.1beta" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  - url: https://github.com/StreamHPC/openmm-hip/archive/refs/tags/{{ version }}.tar.gz
    sha256: b58e3c612204a9e2c301586b226f9b9a368985500914f5d8d4a50cba7839f108
    folder: openmm-hip
  - url: https://github.com/openmm/openmm/archive/refs/tags/8.1.1.tar.gz
    sha256: dc63d7b47c8bb7b169c409cfd63d909ed0ce1ae114d37c627bf7a4231acf488e
    folder: openmm


build:
  number: 0
  skip: True  # [not linux]

requirements:
  build:
    - {{ compiler('c') }}
    - {{ compiler('cxx') }}
    - {{ stdlib('c') }}
    - cmake
    - make
  host:
    - compiler-rt
    - clangdev
    - hip-devel
    - hipcc
    - hipfft
    - lld
    - rocfft
    - rocm-cmake
    - rocm-device-libs
    - openmm {{ version }}
  run:
    - rocfft

test:
  requires:
    - pip
  commands:
    - pip check

about:
  home: https://openmm.org
  summary: Openmm-hip plugin
  description: |
    This plugin adds HIP platform that allows to run OpenMM on CDNA and RDNA AMD GPUs on AMD ROCm open software platform.
  license: MIT
  license_family: MIT
  license_file: licenses/MIT.txt
  dev_url: https://github.com/StreamHPC/openmm-hip

extra:
  recipe-maintainers:
    - zklaus
