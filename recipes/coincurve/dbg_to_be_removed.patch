--- a/setup_support.py	2023-12-26 18:30:52.000000000 -0600
+++ b/setup_support.py	2023-12-27 17:53:54.607456556 -0600
@@ -62,7 +62,6 @@
     from cffi import FFI
 
     try:
-        # raises CalledProcessError if pkg-config is not installed or the lib does not exists
         subprocess.check_output(['pkg-config', '--exists', 'libsecp256k1'])  # noqa S603
 
         includes = subprocess.check_output(['pkg-config', '--cflags-only-I', 'libsecp256k1'])  # noqa S603
@@ -76,7 +75,7 @@
                 with suppress(OSError):
                     FFI().dlopen(path)
                     return True
-        # We couldn't locate libsecp256k1 so we'll use the bundled one
+        # We couldn't locate libsecp256k1, so we'll use the bundled one
         return False


--- a/setup.py	2023-12-26 18:30:52.000000000 -0600
+++ b/setup.py	2023-12-27 15:13:32.962579626 -0600
@@ -281,8 +281,11 @@
     if os.name == 'nt' or sys.platform == 'win32':
         # Apparently, the linker on Windows interprets -lxxx as xxx.lib, not libxxx.lib
         for i, v in enumerate(extension.__dict__.get('extra_link_args')):
-            if v.endswith('.lib'):
-                extension.__dict__['extra_link_args'][i] = f'lib{v}'
+            extension.__dict__['extra_link_args'][i] = v.replace('-L', '/LIBPATH:')
+
+            if v.startswith('-l'):
+                v = v.replace('-l', 'lib')
+                extension.__dict__['extra_link_args'][i] = f'{v}.lib'
 
     setup_kwargs = dict(
         setup_requires=['cffi>=1.3.0', 'requests'],
